<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Account management for Yii including login/logout, lost password, update account, change password.">

    <title>Yii Account Module</title>

    <link href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">
    <link href="css/bootstrap-flatly.css" rel="stylesheet">
    <link href="css/prettify.css" rel="stylesheet" type="text/css">
    <link href="css/main.css" rel="stylesheet" type="text/css">
</head>
<body>

<nav class="navbar navbar-default navbar-fixed-top" role="navigation">

    <a href="https://github.com/cornernote/yii-account-module"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Yii Account Module</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                <!--
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Features <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#features">Features</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#features/screenshots">Screenshots</a>
                        </li>
                    </ul>
                </li>
                -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Installation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#installation">Installation</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#installation/composer-installation">Composer Installation</a>
                        </li>
                        <li>
                            <a href="#installation/manual-installation">Manual Installation</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Configuration <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#configuration">Configuration</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#configuration/accountmodule">AccountModule</a>
                        </li>
                        <li>
                            <a href="#configuration/accountwebuserbehavior">AccountWebUserBehavior</a>
                        </li>
                        <li>
                            <a href="#configuration/custom-routing">Custom Routing</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Usage <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#usage">Usage</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#usage/extending">Extending</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="header">
    <div class="container">
        <div class="jumbotron">
            <h1>Yii Account Module</h1>

            <p>Account management for Yii including login/logout, lost password, update account, change password.</p>

            <p>
                <a class="btn btn-primary btn-lg" role="button" href="#installation">Installation</a>
                <a class="btn btn-default btn-lg" role="button" href="#configuration">Configuration</a>
                <a class="btn btn-default btn-lg" role="button" href="#usage">Usage</a>
            </p>
        </div>
    </div>
</div>

<div class="container">

<div class="section">
    <h2 id="features">Features</h2>
    <ul>
        <li>Provides actions that can be used with current defaults, or easily extended to allow fully customisable account management:
            <ul>
                <li>AccountLoginAction - Login to an account, optional ReCaptcha after 3 login attempts.</li>
                <li>AccountLogoutAction - Logout from an account.</li>
                <li>AccountSignUpAction - Sign up for a new account, can optionally send an account activation email, or can allow direct activation.</li>
                <li>AccountActivateAction - Activate a new account once the secure email link is clicked.</li>
                <li>AccountResendActivationAction - Resends the activation email incase it did not arrive.</li>
                <li>AccountLostPassword - Request an email to be sent which will contain a secure link to allow a password reset, with optional ReCaptcha.</li>
                <li>AccountResetPasswordAction - Checks for valid link and allows resetting the account password.</li>
                <li>AccountUpdateAction - Update own account details.</li>
                <li>AccountChangePasswordAction - Change own password details after verifying current password.</li>
                <li>AccountViewAction - View own account details.</li>
            </ul>
        </li>
        <li>Automatically detect the users timezone on signup.</li>
        <li>Does not impose a data structure, you can use your existing User table with your existing fields.</li>
        <li>Module uses
            <a href="http://cornernote.github.io/yii-email-module/">yii-email-module</a>, allows emails with templates and email queueing.
        <li>Module uses
            <a href="http://getyiistrap.com/">YiiStrap</a>, the ultimate Twitter Bootstrap extension for Yii.
        </li>
    </ul>

    <!--
    <h3 id="features/screenshots">Screenshots</h3>
    -->


</div>

<div class="section">
    <h2 id="installation">Installation</h2>

    <p>Please download using ONE of the following methods:</p>

    <h3 id="installation/composer-installation">Composer Installation</h3>

    <p>All requirements are automatically downloaded into the correct location when using composer. There is no need to download additional files or set paths to third party files.</p>

    <p>Get composer:</p>
    <pre class="prettyprint">curl http://getcomposer.org/installer | php</pre>
    <p>Install latest release OR development version:</p>
<pre class="prettyprint">php composer.phar require cornernote/yii-account-module:*            // latest release
php composer.phar require cornernote/yii-account-module:dev-master    // development version
</pre>
    <p>Add the <code>vendor</code> folder to the <code>aliases</code> in your yii configuration:</p>
<pre class="prettyprint linenums lang-php">return array(
    'aliases' => array(
        'vendor' => '/path/to/vendor',
    ),
);</pre>
    <h3 id="installation/manual-installation">Manual Installation</h3>

    <p>Download the <a href="https://github.com/cornernote/yii-account-module/releases/latest">latest release</a> or
        <a href="https://github.com/cornernote/yii-account-module/archive/master.zip">development version</a> and move the
        <code>account</code> folder into your <code>protected/modules</code> folder.</p>

    <p>In addition the following are required:</p>
    <ul>
        <li>
            <a href="http://www.getyiistrap.com">YiiStrap</a> for the interface elements. Please follow their Getting Started guide to setup the aliases and components for your application.
        </li>
        <li>
            <a href="http://cornernote.github.io/yii-email-module">Yii Email Module</a> to manage email templates and deliver emails.
        </li>
        <li>
            <a href="https://github.com/cornernote/yii-return-url">Yii Return URL</a> to redirect users after actions are performed.
        </li>
    </ul>
</div>

<div class="section">
    <h2 id="configuration">Configuration</h2>

    <h3 id="configuration/accountmodule">AccountModule</h3>

    <p>Add <code>AccountModule</code> to the <code>modules</code> in your yii configuration.</p>

    <p>Minimum configuration:</p>

    <pre class="prettyprint linenums lang-php">return array(
    'modules' => array(
        'account' => array(
            'class' => '/path/to/vendor/cornernote/yii-account-module/account/AccountModule',
        ),
    ),
);</pre>

    <p>Full configuration:</p>

    <pre class="prettyprint linenums lang-php">return array(
    'modules' => array(
        'account' => array(
            // path to the AccountModule class
            'class' => '/path/to/vendor/cornernote/yii-account-module/account/AccountModule',

            // The ID of the CDbConnection application component. If not set, a SQLite3
            // database will be automatically created in protected/runtime/account-AccountVersion.db.
            'connectionID' => 'db',

            // Whether the DB tables should be created automatically if they do not exist. Defaults to true.
            // If you already have the table created, it is recommended you set this property to be false to improve performance.
            'autoCreateTables' => true,

            // If we should allow access to the module controllers.
            // Set to false if you only want to use the actions in your own controllers, the controllers will then throw a 404 error.
            'useAccountUserController' => true,

            // The layout used for module controllers.
            'layout' => 'account.views.layouts.column1',

            // The user class to use for user storage.
            'userClass' => 'AccountUser',

            // The field to store the user's first name, or false to not store the first name.
            'firstNameField' => 'first_name',

            // The field to store the user's last name, or false to not store the last name.
            'lastNameField' => 'last_name',

            // The field to store the user's email address.
            'emailField' => 'email',

            // The field to store the user's username, or false to not store the username.
            'usernameField' => 'username',

            // The field to store the user's password.
            'passwordField' => 'password',

            // The field to store the user's timezone, or false to not store the timezone.
            'timezoneField' => 'timezone',

            // The field to store the user's activated status, or false to not support activation.
            'activatedField' => 'activated',

            // The field to store the user's activated status, or false to not support disabling.
            'disabledField' => 'disabled',

            // Set to false to send the user an email to activate their account.
            'activatedAfterSignUp' => true,

            // The route to use in the email when a user requests a new activation email.
            'resendActivationUrl' => 'account/user/resendActivation',

            // The UserIdentity class you use in your application.
            'userIdentityClass' => 'AccountUserIdentity',

            // Default setting for Remember Me checkbox on login page.
            'rememberDefault' => 0,

            // How long before the Remember Me cookie expires.
            'rememberDuration' => 2592000, // 30 days

            // True if we should spool the emails, or false to send immediately.
            'emailSpool' => true,

            // The function that will send the activation email.
            'emailCallbackActivate' => array('AccountEmailManager', 'sendAccountActivate'),

            // The function that will send the welcome email.
            'emailCallbackWelcome' => array('AccountEmailManager', 'sendAccountWelcome'),

            // The function that will send the lost password email.
            'emailCallbackLostPassword' => array('AccountEmailManager', 'sendAccountLostPassword'),

            // If we should use reCaptcha.
            'reCaptcha' => true,

            // The number of login attempts before reCaptcha is used.
            'reCaptchaLoginCount' => 3,

            // Your public key for recaptcha.
            'reCaptchaPublicKey' => '',

            // Your private key for recaptcha.
            'reCaptchaPrivateKey' => '',

            // The server to use for recaptcha requests.
            'reCaptchaServer' => 'http://www.google.com/recaptcha/api',

            // The server to use for SSL recaptcha requests.
            'reCaptchaSecureServer' => 'https://www.google.com/recaptcha/api',

            // The server to use to verify recaptcha responses.
            'reCaptchaVerifyServer' => 'www.google.com',

            // Mapping from controller ID to controller configurations.
            'controllerMap' => array(
                'user' => 'account.controllers.AccountUserController',
            ),

            // Map of model info including relations and behaviors.
            'modelMap' => array(),

            // The path to YiiStrap.
            // Only required if you do not want YiiStrap in your app config, for example, if you are running YiiBooster.
            // Only required if you did not install using composer.
            // Please note:
            // - You must download YiiStrap even if you are using YiiBooster in your app.
            // - When using this setting YiiStrap will only loaded in the menu interface (eg: index.php?r=menu).
            'yiiStrapPath' => '/path/to/vendor/crisu83/yiistrap',
        ),
    ),
);</pre>

    <h3 id="configuration/accountwebuserbehavior">AccountWebUserBehavior</h3>

    <p>Add to your <code>config/main.php</code></p>
    <pre class="prettyprint linenums lang-php">return array(
    'components' => array(
        'user' => array(
            'class' => 'CWebUser', // your WebUser class
            'allowAutoLogin' => true, // true to allow "Remember Me"
            // the route to the login action (should start with a / to ensure it does not route to a module)
            'loginUrl' => array('/member/login'),
            'behaviors' => array(
                'accountWebUser' => array(
                    'class' => 'account.components.AccountWebUserBehavior',
                ),
            ),
        ),
    ),
);</pre>

    <h3 id="configuration/custom-routing">Custom Routing</h3>
    <pre class="prettyprint linenums lang-php">return array(
    'components' => array(
        'urlManager' => array(
            'urlFormat' => isset($_GET['r']) ? 'get' : 'path', // auto-detection of get/path
            'showScriptName' => false,
            'rules' => array(
                // user account actions at base level
                '&lt;action:(login|logout|signup|lostPassword)&gt;' => '/site/&lt;action&gt;',
            ),
        ),
    ),
);</pre>

</div>

<div class="section">
    <h2 id="usage">Usage</h2>

    <p>The account module will now allow all the default functionality, however you are probably using this module
        because you want to have control over the routing and be able to customise the views and classes.</p>

    <h3 id="usage/extending">Extending</h3>

    <p>To fully customise the actions, you can add them into any controller in your site, for this example we will use
        <code>SiteController</code>. You may also use something like <code>MemberController</code> or
        <code>UserController</code>, however you cannot use
        <code>AccountController</code> because the route will go to the Account Module.</p>

    <pre class="prettyprint linenums lang-php">class SiteController extends CController
{

    public function accessRules()
    {
        return array(
            array('allow',
                'actions' => array('account', 'updateAccount', 'changePassword', 'logout'),
                'users' => array('@'),
            ),
            array('allow',
                'actions' => array('login', 'signup', 'activate', 'lostPassword', 'resetPassword', 'resendActivation'),
                'users' => array('?'),
            ),
            array('deny', 'users' => array('*')),
        );
    }

    public function actions()
    {
        return array(
            'signup' => array(
                'class' => 'account.actions.AccountSignUpAction',
                'view' => 'account.views.account.sign_up',
                'formClass' => 'AccountSignUp',
                'returnUrl' => null, // defaults to returnUrl or homeUrl depending on activatedAfterSignUp setting
            ),
            'activate' => array(
                'class' => 'account.actions.AccountActivateAction',
                'formClass' => 'AccountActivate',
                'returnUrl' => null, // defaults to homeUrl
            ),
            'resendActivation' => array(
                'class' => 'account.actions.AccountResendActivationAction',
                'view' => 'account.views.account.resend_activation',
                'formClass' => 'AccountResendActivation',
            ),
            'lostPassword' => array(
                'class' => 'account.actions.AccountLostPasswordAction',
                'view' => 'account.views.account.lost_password',
                'formClass' => 'AccountLostPassword',
            ),
            'resetPassword' => array(
                'class' => 'account.actions.AccountResetPasswordAction',
                'view' => 'account.views.account.reset_password',
                'formClass' => 'AccountResetPassword',
            ),
            'login' => array(
                'class' => 'account.actions.AccountLoginAction',
                'view' => 'account.views.account.login',
                'formClass' => 'AccountLogin',
            ),
            'logout' => array(
                'class' => 'account.actions.AccountLogoutAction',
            ),
            'account' => array(
                'class' => 'account.actions.AccountViewAction',
                'view' => 'account.views.account.index',
            ),
            'update' => array(
                'class' => 'account.actions.AccountUpdateAction',
                'view' => 'account.views.account.update',
                'formClass' => 'AccountUpdate',
                'returnUrl' => array('/account/user/account'),
            ),
            'changePassword' => array(
                'class' => 'account.actions.AccountChangePasswordAction',
                'view' => 'account.views.account.change_password',
                'formClass' => 'AccountChangePassword',
                'returnUrl' => array('/account/user/account'),
            ),
        );
    }

}</pre>

    <h4>Custom Views</h4>

    <p>You can copy <code>modules/account/views/account/*</code> to
        <code>views/site/*</code>, and modify the code to suit your application.</p>

    <h4>Extending Classes</h4>

    <p>To extend the built-in actions, simply create a class that extends one of the built-in model or action classes,
        then modify to suit your requirements. Once this is done you can update your
        <code>SiteController::actions()</code> with the new class.</p>

</div>

</div>

<div id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <h3>Support</h3>
                <ul class="list-unstyled">
                    <li>Does this site need improvement? Go ahead and
                        <a href="https://github.com/cornernote/yii-account-module/edit/gh-pages/index.html">suggest a change</a>.
                    </li>
                    <li>Found a bug, or need help using this project? Check the
                        <a href="https://github.com/cornernote/yii-account-module/issues">open issues</a> or
                        <a href="https://github.com/cornernote/yii-account-module/issues/new">create an issue</a>.
                    </li>
                </ul>
                <h4>License</h4>

                <p>
                    <a href="license.html" class="fancybox" data-fancybox-type="ajax">BSD-3-Clause</a>, Copyright &copy; 2013-2014
                    <a href="mailto:info@mrphp.com.au">Mr PHP</a></p>
            </div>
            <div class="col-lg-4">
                <h4>Yii Account Module</h4>
                <ul class="list-unstyled">
                    <li><a href="http://cornernote.github.io/yii-account-module">Documentation</a></li>
                    <li><a href="https://github.com/cornernote/yii-account-module">GitHub Project</a></li>
                    <li><a href="http://www.yiiframework.com/extension/yii-account-module">Yii Extension</a>
                    </li>
                </ul>
                <h4>Resources</h4>
                <ul class="list-unstyled">
                    <li><a href="http://getyiistrap.com/">YiiStrap</a></li>
                    <li><a href="http://cornernote.github.io/yii-email-module/">yii-email-module</a></li>
                    <li><a href="https://github.com/cornernote/yii-return-url">yii-return-url</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div id="project-icons" class="text-center">
        <p>
            <a href="http://mrphp.com.au"><img src="https://raw.github.com/cornernote/mrphp-assets/master/img/code-banner.png" alt="Mr PHP"></a>
            <a href="https://www.ohloh.net/p/yii-account-module"><img src="https://www.ohloh.net/p/yii-account-module/widgets/project_thin_badge.gif" alt="Project Stats"></a>
        </p>

        <p>
            <a href="https://packagist.org/packages/cornernote/yii-account-module"><img src="https://poser.pugx.org/cornernote/yii-account-module/v/stable.png" alt="Latest Stable Version"></a>
            <a href="https://travis-ci.org/cornernote/yii-account-module"><img src="https://travis-ci.org/cornernote/yii-account-module.png?branch=master" alt="Build Status"></a>
        </p>
    </div>
</div>

<!-- load js last -->
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
<script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
<script src="js/main.js"></script>

<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-46879709-8', 'cornernote.github.io');
    ga('send', 'pageview');
</script>

</body>
</html>
